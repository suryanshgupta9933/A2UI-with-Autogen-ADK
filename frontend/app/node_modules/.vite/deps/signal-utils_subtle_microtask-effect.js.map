{
  "version": 3,
  "sources": ["../../../../packages/lit/node_modules/signal-utils/src/subtle/microtask-effect.ts"],
  "sourcesContent": ["import { Signal } from \"signal-polyfill\";\n\n// NOTE: this implementation *LEAKS*\n//       because there is nothing to unwatch a computed.\n\nlet pending = false;\n\nlet watcher = new Signal.subtle.Watcher(() => {\n  if (!pending) {\n    pending = true;\n    queueMicrotask(() => {\n      pending = false;\n      flushPending();\n    });\n  }\n});\n\nfunction flushPending() {\n  for (const signal of watcher.getPending()) {\n    signal.get();\n  }\n\n  // Keep watching... we don't know when we're allowed to stop watching\n  watcher.watch();\n}\n\n/**\n * ⚠️ WARNING: Nothing unwatches ⚠️\n * This will produce a memory leak.\n */\nexport function effect(cb: () => void) {\n  let c = new Signal.Computed(() => cb());\n\n  watcher.watch(c);\n\n  c.get();\n\n  return () => {\n    watcher.unwatch(c);\n  };\n}\n"],
  "mappings": ";;;;;;AAKA,IAAIA,UAAU;AAEd,IAAIC,UAAU,IAAIC,OAAOC,OAAOC,QAAQ,MAAM;AAC5C,MAAI,CAACJ,SAAS;AACZA,cAAU;AACVK,mBAAe,MAAM;AACnBL,gBAAU;AACVM,mBAAY;IACd,CAAC;EACH;AACF,CAAC;AAED,SAASA,eAAe;AACtB,aAAWC,UAAUN,QAAQO,WAAU,GAAI;AACzCD,WAAOE,IAAG;EACZ;AAGAR,UAAQS,MAAK;AACf;AAMO,SAASC,OAAOC,IAAgB;AACrC,MAAIC,IAAI,IAAIX,OAAOY,SAAS,MAAMF,GAAE,CAAE;AAEtCX,UAAQS,MAAMG,CAAC;AAEfA,IAAEJ,IAAG;AAEL,SAAO,MAAM;AACXR,YAAQc,QAAQF,CAAC;;AAErB;",
  "names": ["pending", "watcher", "Signal", "subtle", "Watcher", "queueMicrotask", "flushPending", "signal", "getPending", "get", "watch", "effect", "cb", "c", "Computed", "unwatch"]
}
