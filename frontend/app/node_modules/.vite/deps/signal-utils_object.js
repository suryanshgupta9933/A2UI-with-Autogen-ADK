import {
  createStorage
} from "./chunk-IV7QRA2E.js";
import "./chunk-ZDAEO5LF.js";
import "./chunk-PZ5AY32C.js";

// ../packages/lit/node_modules/signal-utils/dist/object.ts.js
var SignalObjectImpl = class _SignalObjectImpl {
  static fromEntries(entries) {
    return new _SignalObjectImpl(Object.fromEntries(entries));
  }
  #storages = /* @__PURE__ */ new Map();
  #collection = createStorage();
  constructor(obj = {}) {
    let proto = Object.getPrototypeOf(obj);
    let descs = Object.getOwnPropertyDescriptors(obj);
    let clone = Object.create(proto);
    for (let prop in descs) {
      Object.defineProperty(clone, prop, descs[prop]);
    }
    let self = this;
    return new Proxy(clone, {
      get(target, prop, receiver) {
        self.#readStorageFor(prop);
        return Reflect.get(target, prop, receiver);
      },
      has(target, prop) {
        self.#readStorageFor(prop);
        return prop in target;
      },
      ownKeys(target) {
        self.#collection.get();
        return Reflect.ownKeys(target);
      },
      set(target, prop, value, receiver) {
        let result = Reflect.set(target, prop, value, receiver);
        self.#dirtyStorageFor(prop);
        self.#dirtyCollection();
        return result;
      },
      deleteProperty(target, prop) {
        if (prop in target) {
          delete target[prop];
          self.#dirtyStorageFor(prop);
          self.#dirtyCollection();
        }
        return true;
      },
      getPrototypeOf() {
        return _SignalObjectImpl.prototype;
      }
    });
  }
  #readStorageFor(key) {
    let storage = this.#storages.get(key);
    if (storage === void 0) {
      storage = createStorage();
      this.#storages.set(key, storage);
    }
    storage.get();
  }
  #dirtyStorageFor(key) {
    const storage = this.#storages.get(key);
    if (storage) {
      storage.set(null);
    }
  }
  #dirtyCollection() {
    this.#collection.set(null);
  }
};
var SignalObject = SignalObjectImpl;
function signalObject(obj) {
  return new SignalObject(obj);
}
export {
  SignalObject,
  SignalObjectImpl,
  signalObject
};
//# sourceMappingURL=signal-utils_object.js.map
